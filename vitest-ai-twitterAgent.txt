
> multi-browser-automation@0.0.30 test
> npx vitest run tests/unit/ai-twitterAgent.test.js


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90mC:/My Script/auto-ai[39m

stderr | tests/unit/ai-twitterAgent.test.js > AITwitterAgent > _diveTweetWithAI > should process found tweet
DIVE TWEET ERROR CAUGHT: [Dive] Dive sequence failed: this.page.locator(...).first is not a function

[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[31mx[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[31mx[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[2m[90m-[39m[22m[33m[39m[32mâ”¬â•–[39m[33m[39m[2m[90m-[39m[22m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[2m[90m-[39m[22m[33m[39m[2m[90m-[39m[22m[33m[39m[2m[90m-[39m[22m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m[33m[39m[32mâ”¬â•–[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 2 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL  tests/unit/ai-twitterAgent.test.js > AITwitterAgent > diveTweet > should handle errors and release lock
TypeError: Cannot read properties of undefined (reading 'catch')
 Î“Â¥Â» AITwitterAgent.diveTweet utils/ai-twitterAgent/index.js:857:40
    855|       if (this.operationLock) {
    856|         this.log(`[DiveLock] â‰¡Æ’Âºâ•£ Force releasing lock in finally block Î“Ã‡Âª
    857|         await this.endDive(false, true).catch(() => {
       |                                        ^
    858|           // Failsafe if endDive itself crashes
    859|           this.operationLock = false;
 Î“Â¥Â» tests/unit/ai-twitterAgent.test.js:572:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/2]Î“Ã„Â»

 FAIL  tests/unit/ai-twitterAgent.test.js > AITwitterAgent > _diveTweetWithAI > should process found tweet
AssertionError: expected "vi.fn()" to be called with arguments: [ true, true ]

Received: 

  1st vi.fn() call:

  [
-   true,
+   false,
    true,
  ]


Number of calls: 1

 Î“Â¥Â» tests/unit/ai-twitterAgent.test.js:687:29
    685| 
    686|       expect(agent.startDive).toHaveBeenCalled();
    687|       expect(agent.endDive).toHaveBeenCalledWith(true, true);
       |                             ^
    688|     });
    689| 

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/2]Î“Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m91 passed[39m[22m[2m | [22m[33m5 skipped[39m[90m (98)[39m
[2m   Start at [22m 06:29:39
[2m   Duration [22m 978ms[2m (transform 318ms, setup 23ms, import 374ms, tests 410ms, environment 0ms)[22m

